# 地址解析协议ARP
> 通过主机或者路由器的IP地址找到相应的机器地址即MAC地址

## ARP高速缓存
每个主机中有一个ARP高速缓存，里面存放着IP地址到映射地址的映射表，并且动态更新（新增或者超时删除）

## 同一个局域网下
1. A主机的目的IP地址在ARP中的映射表内，查出对应的MAC地址写入MAC帧，然后通过局域网将该MAC帧发往此硬件地址
2. 不在映射表内，ARP进程将在本局域网内广播`ARP请求分组`包含`本机MAC 地址` `本机IP 地址` `目标IP 地址`。
3. 本局域网内所有的主机上运行的ARP进程都会收到这个请求分组，与此目的IP地址一致的主机会手下这个ARP 请求分组，并向A主机发送一个` ARP响应分组`包含B 的IP地址和MAC地址， 这个不是广播而是点对点的单播。这是很可能马上B要向A 发送数据报所以会将A的地址映射写入自己的ARP高速缓存中
4. 其余的主机不会理睬这个ARP请求分组。
5. A主机收到这个`ARP响应分组`后将它写入ARP高速缓存

### 不同局域网下
1. 当A 主机得知B 主机不在同一个局域网下，会将数据报发送给路由器，A发送的数据报中的MAC帧中包含的是路由器的MAC 地址（由路由器的ip地址得到mac地址）
2. 路由器接收到之后检查该ip地址是否在另一个网络中，由转发表找到下一跳路由器，同时用ARP解析出mac地址
3. 由下一个路由器进行ARP请求分组广播，或者直接查表得到mac地址，发送的目的主机。

